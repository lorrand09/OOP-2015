lkg=1.00;

%forming shaping function and complex binary data
%%hh1=rcosine(1,8,'sqrt',.25,6);
%in case you don't have comm tool box here is hh1...
%if you do have it you can study effect of filter length.. change 6 to 4...

hh1=[ -0.0005    0.0010    0.0024    0.0032    0.0033    0.0025    0.0010...
      -0.0009   -0.0027   -0.0038   -0.0040   -0.0031   -0.0010    0.0017...
       0.0045    0.0067    0.0075    0.0065    0.0035   -0.0011   -0.0065...
      -0.0116   -0.0151   -0.0159   -0.0133   -0.0070    0.0021    0.0128...
       0.0231    0.0306    0.0333    0.0295    0.0188    0.0017   -0.0194...
      -0.0415   -0.0602   -0.0712   -0.0703   -0.0545   -0.0227    0.0245...
       0.0841    0.1513    0.2198    0.2828    0.3335    0.3663    0.3777...
       0.3663    0.3335    0.2828    0.2198    0.1513    0.0841    0.0245...
      -0.0227   -0.0545   -0.0703   -0.0712   -0.0602   -0.0415   -0.0194...
       0.0017    0.0188    0.0295    0.0333    0.0306    0.0231    0.0128...
       0.0021   -0.0070   -0.0133   -0.0159   -0.0151   -0.0116   -0.0065...
      -0.0011    0.0035    0.0065    0.0075    0.0067    0.0045    0.0017...
      -0.0010   -0.0031   -0.0040   -0.0038   -0.0027   -0.0009    0.0010...
       0.0025    0.0033    0.0032    0.0024    0.0010   -0.0005];

nlen=length(hh1);
hh=hh1/max(hh1);
hh2=hh1*max(hh1);
h = hh;

bndwdth = 1/1000;
theta_0= 2*pi*bndwdth;
eta=sqrt(2)/2;

k_i= (4*theta_0*theta_0)/(1+2*eta*theta_0+theta_0*theta_0);
k_p= (4*eta*theta_0)/(1+2*eta*theta_0+theta_0*theta_0);

%%
% h = rcosine(1, 8, 'fir', .35, 6);
% h = [  2.2279938e-018   1.2826925e-003          2.5731843e-003          3.5872502e-003          4.0712930e-003          3.8725734e-003          2.9911202e-003          1.5965131e-003         -2.4501544e-018         -1.4167090e-003         -2.3025273e-003         -2.4442373e-003         -1.8507012e-003         -7.8632505e-004          2.6484405e-004          7.0748649e-004         -1.7611131e-018         -2.1578188e-003         -5.6608475e-003         -9.9078414e-003         -1.3824216e-002         -1.6018322e-002         -1.5062068e-002         -9.8546412e-003          1.1290847e-017          1.3888205e-002          3.0040975e-002          4.5615342e-002          5.7033695e-002          6.0562455e-002          5.3058198e-002          3.2762809e-002         -2.3867582e-017         -4.2378280e-002         -8.8921658e-002         -1.3196052e-001         -1.6243451e-001         -1.7108889e-001         -1.4988203e-001         -9.3393399e-002          3.4700647e-017          1.2739293e-001          2.8122422e-001          4.4982174e-001          6.1858415e-001          7.7165891e-001          8.9388952e-001          9.7275286e-001          1.0000000e+000          9.7275286e-001          8.9388952e-001          7.7165891e-001          6.1858415e-001          4.4982174e-001          2.8122422e-001          1.2739293e-001          3.4700647e-017         -9.3393399e-002         -1.4988203e-001         -1.7108889e-001         -1.6243451e-001         -1.3196052e-001         -8.8921658e-002         -4.2378280e-002         -2.3867582e-017          3.2762809e-002          5.3058198e-002          6.0562455e-002          5.7033695e-002          4.5615342e-002          3.0040975e-002          1.3888205e-002          1.1290847e-017         -9.8546412e-003         -1.5062068e-002         -1.6018322e-002         -1.3824216e-002         -9.9078414e-003         -5.6608475e-003         -2.1578188e-003         -1.7611131e-018          7.0748649e-004          2.6484405e-004         -7.8632505e-004         -1.8507012e-003         -2.4442373e-003         -2.3025273e-003         -1.4167090e-003         -2.4501544e-018          1.5965131e-003          2.9911202e-003          3.8725734e-003          4.0712930e-003          3.5872502e-003          2.5731843e-003          1.2826925e-003          2.2279938e-018        ];

